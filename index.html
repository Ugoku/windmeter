<!DOCTYPE html>
<html>
<head lang="en">
	<meta charset="UTF-8">
	<title></title>
	<style>
		div,meter,output {
			display: -webkit-flex;
			display: flex;
		}
		body {
			flex-direction: column;
		}
		body > div {
			flex-direction: row;
			justify-content: space-around;

			-webkit-flex: 1 0 auto;
			flex: 1 0 auto;
		}
		meter {
			max-width: 50%;
		}
		#winddirection {
			font-size: 2em;
		}
	</style>
</head>
<body>
	<div>
		<meter id="windspeed" max="50"></meter>
		<!--<meter id="winddirection" max="359"></meter>-->
		<span id="winddirection">⇩</span>
		<meter id="temperature" max="50"></meter>
	</div>
	<div>
		<output id="windspeed-txt"></output>
		<output id="winddirection-txt"></output>
		<output id="temperature-txt"></output>
	</div>
	<button id="js-stop">Stop</button>
	<script>
		var source = new EventSource('stream.php');
		source.addEventListener('message', function(e) {
			var wind = JSON.parse(e.data);

			document.getElementById('windspeed').value = wind.windspeed;
			document.getElementById('windspeed-txt').value = 'Wind speed: ' + wind.windspeed + 'kt';

			document.getElementById('winddirection').style.transform ='rotate(' + wind.winddir + 'deg)';
			document.getElementById('winddirection-txt').value = 'Direction: ' + wind.winddir + '°';

			document.getElementById('temperature').value = wind.temp;
			document.getElementById('temperature-txt').value = 'Temperature: ' + wind.temp + '°';
		}, false);
		document.getElementById('js-stop').addEventListener('click', function(){
			source.close();
		});
	</script>
</body>
</html>